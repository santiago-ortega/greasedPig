#######################################################################
# Copyright 2017 IBM Corp. All Rights Reserved.
#
# Licensed under the Apache License, Version 2.0 (the "License"); you
# may not use this file except in compliance with
# the License. You may obtain a copy of the License at
#
# http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
# implied. See the License for the specific language governing
# permissions and limitations under the License.
#######################################################################

#Generated by Kickstart Configurator
#platform=x86

#System language
lang en_US
#Language modules to install
langsupport en_US
#System keyboard
keyboard us
#System mouse
mouse
#System timezone
timezone --utc America/New_York
#Root password
rootpw --disabled
#Initial user
user k8s --fullname "k8s" --iscrypted --password $1$lzuGyRHe$uOWMPoAfAyRlgUYUPGrUI.
#Reboot after installation
reboot
#Use text mode install
text
#Install OS instead of upgrade
install
#Use CDROM installation media
cdrom
#System bootloader configuration
bootloader --location=mbr --md5pass=$1$XBpRFBlW$D.LiZHQoS4tXbCHnQisBG1
#Clear the Master Boot Record
zerombr yes
#Partition clearing information
clearpart --all --initlabel
#Disk partitioning information
part / --fstype ext4 --size 70000
part swap --size 10000
part /home --fstype ext4 --size 19500
part /boot --fstype ext4 --size 500
part /var --fstype ext4 --size 5000
part /tmp --fstype ext4 --size 5000
#System authorization infomation
auth  --useshadow  --enablemd5
#Network information
network --bootproto=dhcp --device=eth0
#Firewall configuration
firewall --enabled --trust=eth0 --ssh
#Do not configure the X Window System
skipx
# Additional packages to install
# - Uncomment the open-vm-tools line if this is going to run in vmware and are
#   not going to use vmware-tools that's distributed with it. Don't think the
#   --no-install-recommends is needed to not install desktop tools but doesn't
#   hurt anything
%packages
# Since I don't install recommended it leaves out some things that should
# probably be installed like openssl and python 2.7
#ca-certificates
ubuntu-standard
openssh-server
python
#wget
#tcpd
# End all the recommended packages that are still useful
openssh-server
#open-vm-tools --no-install-recommends
#curl
#screen
#vim

%post
# Why vim doens't just set background=dark by default is beyond me
#echo "set background=dark" >>/etc/vim/vimrc.local

# Change default umask from 022 to 027 (not world readable). Remove this line
# if you don't want that
#sed -i -e 's/^\(UMASK\W*\)[0-9]\+$/\1027/' /etc/login.defs

# Add noatime to /etc/fstab
#sed -i -e 's/\(errors=remount-ro\)/noatime,\1/' /etc/fstab
#sed -i -e 's/\(boot.*defaults\)/\1,noatime,nodev/' /etc/fstab
#sed -i -e 's/\(home.*defaults\)/\1,noatime,nodev/' /etc/fstab
#sed -i -e 's/\(usr.*defaults\)/\1,noatime,nodev/' /etc/fstab
# Not 100% sure if /var can be nodev
#sed -i -e 's/\(var.*defaults\)/\1,noatime,nodev/' /etc/fstab

# Clean up
#apt-get -qq -y autoremove
#apt-get clean
#rm -f /var/cache/apt/*cache.bin
#rm -f /var/lib/apt/lists/*
